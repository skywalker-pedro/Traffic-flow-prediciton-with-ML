\label{chapter:trabalhos_relacionados}

Este capítulo tem como objetivo apresentar trabalhos relacionados à predição de tráfego urbano, mostrar suas contribuições e contextualizar a monografia. Para selecionar os trabalhos, foi utilizado uma metodologia de busca baseada em artigos de alto impacto e com grande quantidade de citações, resultando em 8 trabalhos expostos. Esse capítulo será divido em três partes. A primeira seção expõe os trabalhos relacionados que utilizam algoritmos de aprendizado profundo em seus modelos. A segunda seção apresenta trabalhos da área de predição de fluxo de veículos que utilizam algoritmos tradicionais. Por fim, a última seção apresenta uma breve discussão a respeito de todos os artigos mencionados. 

\section{Trabalhos que Utilizam Aprendizado Profundo}

No trabalho de Zainab Abbas et. al. \cite{Zainab_2018} é apresentado um modelo de predição de tráfego (utilizando a densidade\footnote{Densidade (\(k\)) é calculada como o fluxo de veículos (\(q\)) divida pela velocidade média (\(v\)) deles em um intervalo de tempo (\(k = \frac{q}{v} \)).} da via em vez do fluxo) objetiva antecipar congestionamentos em rodovias de Estocolmo, Suécia, utilizando aprendizado profundo. No caso, o autor propõe uma variação do \textit{\acrshort{LSTM}}, mais precisamente \textit{\acrfull{SLSTM}}. Para tal, são utilizados dados coletados por sensores do sistema de controle da autoestrada da cidade. Tais sensores monitoram as principais vias da metrópole e coletam informações como fluxo e velocidade de cada faixa a cada 1 minuto. O trabalho propõe três modelos de predição de densidade da via:

\begin{itemize}
    \item \textbf{(1 para 1)}: Modelo utilizando apenas um sensor que faz a predição apenas do local daquele sensor
    \item \textbf{(n para n)}: Modelo que utiliza n sensores de uma determinada área e faz a predição de todas as localidades
    \item \textbf{(m para n)}: Modelo que utiliza os m sensores mais significantes de uma área que contém um total de n sensores e que faz a predição para todos os n locais.
\end{itemize}

Dos três modelos apresentados, o mais eficiente foi o m-n, pois faz a previsão de tráfego em vários pontos diferentes da via e tem um custo computacional menor que o n-n, pois utiliza menos sensores, o que diminui os dados de entrada da rede neural. Esse modelo foi comparado com outros usando as métricas \textit{\acrfull{RMSE}}\footnote{RMSE é o desvio padrão dos erros de predição. Ela é utilizada para ver quão distante está uma sequência de outra. Quanto menor o valor, melhor.} e \textit{\acrfull{MAE}}\footnote{MAE é a média dos erros de predição. Ela é utilizada para ver o erro esperado de predição. Quanto menor o valor, melhor}. O resultado dessas métricas é comparado com a acurácia de outros modelos como \textit{\acrshort{RNN}} e \textit{\acrfull{FFN}}. O erro calculado foi menor na metodologia proposta pelo autor em todos os casos, comprovando a eficácia do modelo apresentado (\textit{\acrshort{SLSTM}}).

No artigo de Yisheng Lv et. al. \cite{lv_6894591} foi proposto um trabalho semelhante de comparação de modelos de predição, mas utilizando \textit{\acrfull{SAE}}. O modelo de predição proposto pelo artigo é aplicado aos dados coletados por 15,000 sensores espalhados pelas estradas da Califórnia. As predições são divididas em intervalos de 15, 30, 45 e 60 minutos. Mais uma vez, a acurácia dos testes foi medida utilizando  \textit{\acrshort{MAE}}, \textit{\acrshort{RMSE}} e \textit{\acrfull{MRE}}\footnote{MRE é a média dos erros de predição relativos a amostra. Ela é utilizada para se poder comparar entre conjuntos que mudam de tamanho. Quanto menor o valor, melhor.} para cada intervalo de tempo e comparada com a acurácia de predição de outros métodos, como
\textit{\acrshort{SVM}}, \textit{\acrfull{BPNN}}, \textit{\acrfull{RW}} e \textit{\acrfull{RBFNN}}. Dos métodos utilizados no trabalho, nenhum paramétrico foi considerado. Seria interessante ter adicionado algum modelo deste tipo nas comparações, como o \textit{\acrfull{ARIMA}}, trouxesse um panorama de como os modelos paramétricos se comportam com o conjunto de dados propostos. Por fim, são apresentados os resultados finais do trabalho e, novamente, o método proposto pelo autor foi o que obteve os melhores resultados. 

Um modelo mais próximo do utilizado nos testes da monografia aqui apresentada, é descrito  por Yong-Ju Lee et. al. \cite{Seoul}. Diferentemente dos trabalhos relacionados apresentados nos parágrafos anteriores, esse artigo apresenta um estudo feito com dados coletados de vias urbanas de Seul, e não somente de rodovias expressas. O trabalho utiliza 3 bases de dados diferentes:

\begin{itemize}
    \item Uma base gerada sinteticamente pela \textit{SK Planet Company}.
    \item Uma base coletada do governo metropolitano de Seul.
    \item Uma base de dados coletada do \textit{Aplicatio T-Map}, considerado a aplicação de navegação mais utilizada da Coreia.
\end{itemize} 

Além das 3 bases de dados, também foi adicionado ao modelo uma variável para medir o impacto das condições climáticas sobre o tráfego.
Para a predição, foram utilizados o \textit{\acrshort{LSTM}}, \textit{\acrshort{GRU}} e um método proposto chamado \textit{\acrfull{MLSTM}}. Nos testes feitos, o método de avaliação foi o \textit{\acrshort{RMSE}}, para o qual o \textit{\acrshort{MLSTM}} se mostrou mais eficiente, seguido do \textit{\acrshort{LSTM}} comum e do \textit{\acrshort{GRU}}. Porém, a diferença do \textit{\acrshort{RMSE}} entre os 3 algoritmos não ultrapassou 0.1, o que demonstra que a eficácia de todos os métodos é bem similar para o conjunto de dados do trabalho. Vale ressaltar também que todos os modelos utilizados neste trabalho se encaixam na categoria de aprendizado profundo e derivam de redes neurais recorrentes, o que pode explicar a performance tão similar dos modelos.

Em  \cite{fu2016using} por Rui Fu et. al. tem-se novamente o mesmo problema de predição de tráfego. Porém, segundo o autor, é apresentado pela primeira vez na literatura uma proposta de utilização de \textit{\acrshort{GRU}} para esse tipo de problema. No caso, o trabalho compara três modelos, sendo eles \textit{\acrshort{ARIMA}}, \textit{\acrshort{LSTM}} e \textit{\acrshort{GRU}}. Os dados utilizados pelo trabalho citado foram disponibilizados publicamente pelo governo, \textit{PeMS}, mais especificamente de \textit{Bay Area}, \textit{Alameda}, \textit{Oakland} nos Estados Unidos. 

Para o treinamento foram utilizados 50 séries temporais, cada uma gerada por um sensor diferente. Já para as métricas, assim como na maioria dos trabalhos relacionados, foram utilizados o \textit{\acrshort{MAE}} e \textit{\acrfull{MSE}}\footnote{MSE é a soma dos quadrados dos erros de predição. Ela é utilizada para ver quão distante está uma sequência da outra. Quanto menor o valor, melhor}. Ao fim do experimento, os modelos apresentaram resultados similares, sem uma diferença muito significativa entre eles. Porém, o modelo \textit{\acrshort{GRU}} se mostrou superior ao \textit{\acrshort{LSTM}} para 84\% das séries temporais utilizadas e os modelos não paramétricos. De forma geral, demonstraram uma melhor capacidade de se ajustar aos dados se comparados ao modelo paramétrico utilizado nas comparações.

Uma observação pertinente acerca dos experimentos desse trabalho, é que o conjunto de dados utilizados é originado de dados coletados por 50 sensores diferentes. Então, assim como no artigo de Zainab et. al. \cite{Zainab_2018}, poderia ter-se utilizado de uma metodologia de agrupamento de sensores para verificar como os modelos responderiam a mais dados agrupados.

\section{Trabalhos que Utilizam Algoritmos Tradicionais}

A maioria dos trabalhos na área de predição de fluxo descarta os fatores aleatórios e considera apenas cenários ideais, descartando também os períodos de manutenção, onde ocorre a total, ou parcial interrupção das vias. Porém, Yi Hou et al. \cite{hou2014traffic} realizaram um trabalho de predição de fluxo justamente nessas condições e, segundo os próprios autores, a falta de trabalhos da área para este tipo de cenário foi a motivação principal da pesquisa. 

O trabalho de Yi Hou apresenta um modelo de predição de fluxo em duas rodovias do \textit{Missouri}, nos Estados Unidos, mais precisamente em \textit{St.Louis}. Ambas as rodovias apresentaram um total de 161 zonas de trabalho rodoviários (ou \textit{Work Zones} como descrito pelo artigo) ao longo do ano em que os dados foram coletados (Junho de 2012 até Setembro de 2013). \textit{Work Zones} são áreas de manutenção, ou construção, onde as rodovias apresentam placas de desvio, barreiras e bloqueio de algumas faixas. Outro ponto que deve ser notado é que as duas rodovias são diferentes entre si, uma delas é uma via expressa e a outra é uma via arterial sinalizada com semáforos.

Para realizar as predições, Yi Hou et al. utilizaram de 3 modelos de aprendizado de máquina e uma base de comparação. Os modelos utilizados foram \textit{\acrshort{RF}}, uma \textit{\acrfull{NN}} e uma árvore de regressão simples. Assim como a maioria dos trabalhos da área de predição de fluxo, para calcular o erro e comparar os modelos, foram utilizadas as métricas \textit{\acrshort{RMSE}}, \textit{\acrshort{MAE}} e \textit{\acrfull{MAPE}}\footnote{MAPE mede a qualidade dos predição. Ela é utilizada para ver quão preciso está a previsão embora seja enviesada para previsões abaixo do esperado. Quanto maior, melhor.}. Suas predições consistem em quatro predições de curto prazo (15, 30, 45 e 60 minutos no futuro) e uma predição de longo prazo (24 horas no futuro). Em todos os casos, o modelo \textit{\acrshort{RF}} se mostrou melhor que seus concorrentes e melhor que a base de comparação. O trabalho do autor se difere ao prever o fluxo de veículos em áreas que não continham as condições ideais.


Outro trabalho que também foge da abordagem tradicional é o apresentado por Xianglong Luo et. al. \cite{luo2019traffic}. O autor se propõe a construir um modelo de predição de fluxo de veículos para feriados, analisando as flutuações e sazonalidades desses dias. O conjunto de dados utilizado no trabalho foi coletado por fiscalizadores eletrônicos encontrados em estações de pedágio espalhadas pela rodovia de \textit{Jiangsu}, uma província chinesa. Para realizar as predições, o autor propõe um modelo que combina \textit{\acrfull{DFT}} com \textit{\acrshort{SVR}}. Utilizando o \textit{\acrshort{DFT}}, é extraído dos dados a tendência dos mesmos e sua distribuição. Para calcular as flutuações do fluxo (que acontecem principalmente nos feriados), é utilizado o \textit{\acrshort{SVR}}. Gerando assim o modelo \textit{\acrfull{DFT-SVR}}.

Depois de calculadas a tendência e as flutuações dos dados, o autor combina os resultados para gerar a predição de fluxo nos dias de feriado, mais especificamente, os feriados \textit{Tomb-Sweeping Day} e \textit{National Day}. Para validar os seus resultados, Xianglong Luo et. al. utilizam outros três modelos para comparação: \textit{\acrshort{ARIMA}}, \textit{\acrshort{SVR}} e \textit{\acrfull{EMD-SVR}}. Como métrica de comparação, é utilizado \textit{\acrshort{MAPE}}, \textit{\acrshort{MAE}} e \textit{\acrshort{RMSE}}.  Para ambos os feriados, as predições do modelo proposto pelo autor (o \textit{\acrshort{DFT-SVR}}) foram superiores a todas as outras. O trabalho foi inovador ao escolher por analisar as flutuações e \textit{outliers} dos dados, visto que a maioria dos trabalhos na literatura escolhe por analisar a tendência principal do fluxo das vias.

No artigo \cite{Hu2016} apresentado por Wenbin Hu et. al. é proposto uma variação do \textit{\acrshort{SVR}}, \textit{\acrfull{PSO-SVR}}. A escolha do \textit{\acrshort{SVR}} se deve ao método ter um extenso uso na literatura para problemas não lineares e predições de séries temporais. Além disso, de acordo com os estudos do autor, a \textit{\acrshort{SVR}} possui a capacidade de achar a melhor solução global para problemas deste tipo. Nessa variação é utilizado \textit{\acrfull{PSO}} para a escolha de parâmetros do \textit{\acrshort{SVR}}. Esse trabalho se diferencia ao fazer a junção dos dois métodos, pois os modelos na literatura não costumam ser adaptativos, isto é, não são capazes de se adaptar ao conjunto de dados que estão utilizando, para assim prover uma solução precisa em tempo real. Para avaliar a performance do modelo, é utilizado \textit{\acrshort{RMSE}} e \textit{\acrfull{R2}}\footnote{R2 é a medida de quão próximo as previsões estão do dados. Quanto maior o valor, melhor}. O artigo também afirma que o modelo proposto é superior ao estado da arte, porém não fornece uma referência que embase esta afirmação.

Yanyan Xu et. al. \cite{xu2013short} mostrou um trabalho promissor acerca de previsão de fluxo utilizando árvores de regressão. O autor se propôs a prever o fluxo em cinco pontos distintos em uma rodovia interestadual localizada em \textit{Portland}, nos Estados Unidos.

Além do modelo de árvore de regressão proposto pelo autor, foram utilizados outros dois modelos para serem comparados. São eles: o modelo paramétrico \textit{Kalman Filter} e o modelo não paramétrico \textit{\acrfull{KNN}}. Para avaliação dos resultados, foram utilizadas as métricas \textit{\acrshort{MAPE}}, que é comumente utilizada em trabalhos do gênero, e a métrica \textit{\acrfull{MASE}} proposta pelo autor, pois, segundo o mesmo, com esta métrica é possível comparar os resultados não apenas de modelos diferentes para um mesmo conjunto de dados, mas também de modelos diferentes com conjunto de dados diferentes. 
Quanto as previsões, o trabalho apresentou predições de fluxo de curto prazo para todas as cinco localidades (15 minutos no futuro) e em todos os testes o modelo proposto pelo autor se mostrou superior. %Apesar dos resultados favoráveis aos modelos não paramétricos (em especial à arvore de regressão), talvez fosse mais interessante caso tivessem sido incluídos modelos não paramétricos considerados mais robustos e promissores na área de predição de fluxo, como \textit{\acrshort{SVM}}, ou algum modelo de redes neurais recorrentes. 

\section{Críticas}

Como visto acima, os trabalhos da área de predição de fluxo de veículos tendem a seguir um padrão. Normalmente, é escolhido um modelo principal proposto pelo artigo, que é então comparado com os modelos definidos como base de comparação. Pode-se perceber também que as métricas utilizadas para avaliação dos resultados mais recorrentes são as \textit{\acrshort{MAE}} e \textit{\acrshort{RMSE}}. Embora o uso dessas métricas seja adequado para o tipo de problema proposto pelos trabalhos, seria interessante utilizar uma métrica que calculasse o erro da predição de maneira independente do conjunto de dados utilizados, pois dessa forma seria possível comparar a performance dos modelos de trabalhos distintos, facilitando a avaliação dos mesmos.

Também é notável que apesar da maioria dos trabalhos explicar como funcionam os modelos expostos nos testes, poucos se preocupam em expor a metodologia utilizada para realizar o treinamento dos mesmos, assim como quais são os valores de parâmetros e hiper-parâmetros utilizados, ou como se chegou a tais valores. Visto que a performance de um modelo pode melhorar significativamente após o ajuste de parâmetros (\textit{tuning}) e que a maneira como é realizado o treinamento também influencia na qualidade das predições, a etapa de ajuste dos parâmetros e hiper-parâmetros e a etapa de treinamento (qual a técnica utilizada) são pontos que deveriam ter mais atenção nos trabalhos da literatura acerca da predição de fluxo de veículos.